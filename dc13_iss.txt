<VirtualHost *:80>
     ServerAdmin hosting@plateau.com
     ServerName 0000defaultvhost.plateau.com
     DocumentRoot "/srv/www/htdocs"

SSLProxyEngine on

###### ICONTENT ###########
## Contact Greg Hawkins with Questions x202 ##

#iContent Entitlement Specific  - GH
# Prevent access to content outside iContent Entitlement
RewriteEngine On
RewriteCond %{HTTP_COOKIE} !AKAMAI_AUTH_COOKIE
RewriteRule ^/icontent_e/(.*)$ - [F]

#proxy rot specific to the rot iis server
<Proxy balancer://icontent_CUSTOM_dc13>
BalancerMember http://10.116.39.58/icontent/CUSTOM_dc13/ disablereuse=on keepalive=off retry=10
BalancerMember http://10.116.36.34/icontent/CUSTOM_dc13/ disablereuse=on keepalive=off retry=10
</Proxy>
<Proxy balancer://icontent_e_CUSTOM_dc13>
BalancerMember http://10.116.39.58/icontent_e/CUSTOM_dc13/ disablereuse=on keepalive=off retry=10
BalancerMember http://10.116.36.34/icontent_e/CUSTOM_dc13/ disablereuse=on keepalive=off retry=10
</Proxy>
<Proxy balancer://icontent_self-managed_dc13>
BalancerMember http://10.116.39.58/icontent/self-managed_dc13/ disablereuse=on keepalive=off retry=10
BalancerMember http://10.116.36.34/icontent/self-managed_dc13/ disablereuse=on keepalive=off retry=10
</Proxy>

#non rot specific content goes to ashburn icontent server
#<Proxy balancer://icontent>
 #       BalancerMember https://icontent.plateau.com/icontent/ disablereuse=on keepalive=off retry=10

#</Proxy>

#<Proxy balancer://icontent_e>
 #       BalancerMember https://icontent.plateau.com/icontent_e/ disablereuse=on keepalive=off retry=10
#</Proxy>

<Proxy balancer://session>
        BalancerMember https://icontent.plateau.com/session/ disablereuse=on keepalive=off retry=10
</Proxy>

ProxyPreserveHost Off
ProxyPass /icontent/CUSTOM_dc13/ balancer://icontent_CUSTOM_dc13/
ProxyPass /icontent_e/CUSTOM_dc13/ balancer://icontent_e_CUSTOM_dc13/
ProxyPass /icontent/self-managed_dc13/ balancer://icontent_self-managed_dc13/

SSLProxyVerify none
ProxyRemote https://icontent.plateau.com/ https://localhost:8443

ProxyPass /icontent/ balancer://icontent/
ProxyPass /icontent_e/ balancer://icontent_e/

ProxyPass /session/ balancer://session/

</VirtualHost>
